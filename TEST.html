<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>평택진위쌍용스마트어반</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    /* Basic body styles */
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
      color: #333;
      line-height: 1.6;
      overflow-x: hidden; /* 가로 스크롤 방지 */
    }
    /* Header styles */
    header {
      background-color: #004d40;
      color: #fff;
      height: 60px;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
    .logo a {
      color: #fff;
      text-decoration: none;
      font-size: 1.2em;
      font-weight: bold;
    }

    /* Navigation menu styles (desktop) */
    .nav-menu ul {
      list-style: none;
      display: flex; /* Horizontal alignment for desktop */
      gap: 15px;
      margin: 0;
      padding: 0;
    }
    .nav-menu ul li a {
      color: #fff;
      text-decoration: none;
      padding: 8px 12px;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }
    .nav-menu ul li a:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    /* Hamburger menu button (hidden on desktop) */
    .hamburger-menu {
      display: none;
      background: rgba(255, 255, 255, 0.1); /* Subtle background */
      border: none;
      cursor: pointer;
      padding: 10px;
      z-index: 1005; /* Above navigation menu */
      margin-left: auto; /* Push to the right */
      border-radius: 4px; /* Rounded corners for the button */
      transition: background-color 0.3s ease; /* Smooth transition */
    }
    .hamburger-menu:hover {
      background: rgba(255, 255, 255, 0.2); /* Slightly more opaque on hover */
    }
    .hamburger-menu span {
      display: block;
      width: 25px;
      height: 3px;
      background-color: #fff;
      margin: 5px 0;
      transition: all 0.3s ease-in-out;
    }

    /* Hamburger menu active state (changes to X shape) */
    .hamburger-menu.active span:nth-child(1) {
      transform: translateY(8px) rotate(45deg);
    }
    .hamburger-menu.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger-menu.active span:nth-child(3) {
      transform: translateY(-8px) rotate(-45deg);
    }

    /* Container for main content */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    /* Intro section styles */
    .intro {
      text-align: center;
      padding: 20px;
      margin-top: 30px;
    }
    .intro h2 {
      color: #004d40;
      margin-bottom: 15px;
    }
    .intro p {
      font-size: 1.1em;
      color: #555;
    }
    /* Form section styles */
    .form-section {
      width: 100%;
      max-width: 800px;
      margin: 0 auto 60px;
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      box-sizing: border-box; /* 패딩이 너비에 포함되도록 설정 */
    }
    .form-section h3 {
      margin-bottom: 20px;
      color: #004d40;
      text-align: center;
    }

    .form-section label:not([for="agreeCheckbox"]) {
        display: block;
        margin-top: 15px;
        margin-bottom: 5px;
        font-weight: 500;
        color: #333;
    }

    .form-section input,
    .form-section select,
    .form-section textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1em;
      box-sizing: border-box;
    }
    .form-section textarea {
        margin-bottom: 15px;
    }

    .form-section label[for="agreeCheckbox"] {
        display: flex;
        align-items: center;
        font-weight: normal;
        margin-top: 15px;
        font-size: 0.9em;
        color: #555;
        cursor: pointer;
    }
    .form-section label[for="agreeCheckbox"] input[type="checkbox"] {
        width: auto;
        margin-right: 8px;
        margin-bottom: 0;
    }

    .form-section button {
      padding: 12px 25px;
      background-color: #004d40;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1.1em;
      width: 100%;
      margin-top: 10px;
      transition: background-color 0.3s ease;
    }
    .form-section button:hover:not(.btn-disabled) {
      background-color: #00332d;
    }
    .form-section button.btn-disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    .form-section button.btn-disabled:hover {
      background-color: #bbb;
    }

    .privacy-text {
      font-size: 0.9em;
      color: #777;
      margin-top: 15px;
      line-height: 1.4;
    }

    /* Event banner styles */
    .event-banner {
      animation: sparkle 1s infinite alternate;
      background-color: #ff9800;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6px 20px;
      font-size: 1.1em;
      font-weight: bold;
      text-align: center;
      margin-top: 60px;
    }

    /* Intro image section with canvas background */
    .intro-image-section {
      position: relative;
      width: 100vw; /* 뷰포트 너비에 강제 맞춤 */
      height: calc(100vh - 60px - 42px); /* Adjust height based on header and banner */
      min-height: 400px;
      overflow: hidden;
    }
    .intro-image-section img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .intro-image-section .overlay-text {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      text-align: center;
      width: 90%;
      max-width: 800px;
    }
    .intro-image-section .overlay-text h2 {
      font-size: 2.8em;
      font-weight: bold;
      color: transparent;
      background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 200% auto;
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: neonStroke 10s linear infinite;
      margin: 0;
    }
    /* Responsive styles - mobile */
    @media (max-width: 768px) {
        .intro-image-section .overlay-text h2 {
            font-size: 2em;
        }
        .intro-image-section {
             height: calc(100vh - 60px - 52px); /* Adjusted for mobile banner height */
        }

        /* Mobile navigation */
        .nav-menu > ul { /* Hide horizontal menu */
            display: none;
        }
        .hamburger-menu { /* Show hamburger button */
            display: block; 
        }

        /* Navigation menu when open (mobile) */
        .nav-menu.nav-open > ul {
            display: flex;
            flex-direction: column; /* Vertical alignment */
            position: absolute;
            top: 60px; /* Below header */
            left: 0;
            right: 0; /* Equivalent to width: 100%; */
            background-color: #004d40; /* Same as header background */
            padding: 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 999; /* Above other content */
        }
        .nav-menu.nav-open > ul li {
            width: 100%;
            text-align: center;
        }
        .nav-menu.nav-open > ul li a {
            display: block; /* Make entire link area clickable */
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }
        .nav-menu.nav-open > ul li:last-child a {
            border-bottom: none;
        }
        .nav-menu.nav-open > ul li a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Mobile-only line break */
        .mobile-only-break {
          display: block; /* Show on mobile */
        }
    }

    /* Desktop-only line break */
    .mobile-only-break {
      display: none; /* Hidden by default on desktop */
    }

    .highlight-title {
      font-size: 1.8em;
      font-weight: 700;
    }
    /* Keyframe animations */
    @keyframes fadeInLogo {
      0% { opacity: 0; transform: translate(-50%, -60%) scale(0.5); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    @keyframes sparkle {
      0% {
        background-color: #ff9800;
        box-shadow: 0 0 5px #ff9800;
      }
      100% {
        background-color: #ffc107;
        box-shadow: 0 0 20px #ffc107;
      }
    }
    @keyframes neonPulse {
      0% {
        filter: drop-shadow(0 0 5px rgba(0,255,255,0.5)) drop-shadow(0 0 10px rgba(0,255,255,0.5));
      }
      100% {
        filter: drop-shadow(0 0 20px rgba(0,255,255,1)) drop-shadow(0 0 30px rgba(0,255,255,1));
      }
    }
    @keyframes fadeInEntrance {
      0% {
        opacity: 0;
        transform: translate(-50%, -60%) scale(0.5);
      }
      100% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }
    @keyframes neonStroke {
      0% {
        background-position: 200% center;
      }
      100% {
        background-position: -200% center;
      }
    }
    /* Sparkle and Shooting Star canvas styles */
    #sparkle-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%; /* Fit parent width */
      height: 100%; /* Fit parent height */
      pointer-events: none; /* Allows clicks to pass through to elements below */
      z-index: 1; /* Ensure it's above the background image */
      display: block;
    }
    /* Explicit z-index for background image to ensure correct layering */
    .intro-image-section img:first-of-type {
      z-index: 0; /* Place background image below canvas */
    }
    /* Explicit z-index for overlay text for clarity */
    .intro-image-section .overlay-text {
      z-index: 3; /* Place overlay text above canvas and logo */
    }

</style>
</head>
<body>
  <header>
    <div class="logo">
      <a href="index.html" style="display: flex; align-items: center; gap: 8px; color: #fff; text-decoration: none; font-size: 1.2em; font-weight: bold;">
        <img src="https://github.com/JUNGDONGSU/smate-urban/blob/main/logo1.png?raw=true" alt="쌍용 로고" style="height: 28px; width: auto; vertical-align: middle;">
        쌍용 스마트어반
      </a>
    </div>
    <button class="hamburger-menu" aria-label="메뉴 열기" aria-expanded="false" aria-controls="navigation-menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <nav class="nav-menu">
      <ul id="navigation-menu">
        <li><a href="business.html">사업안내</a></li>
        <li><a href="location.html">입지안내</a></li>
        <li><a href="complex.html">단지안내</a></li>
        <li><a href="unit.html">세대안내</a></li>
        <li><a href="tel:1688-5925">1688-5925</a></li>
      </ul>
    </nav>
  </header>

  <div class="event-banner">
    🎉 분양 상담 예약 시, 특별 사은품 증정 이벤트 진행 중! 지금 바로 문의하세요!
  </div>

  <section class="intro-image-section">
    <canvas id="sparkle-canvas"></canvas> 
    <img src="https://github.com/JUNGDONGSU/smate-urban/blob/main/main153009511_03.svg?raw=true" alt="쌍용 스마트어반 SVG 배경" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
    <img src="https://github.com/JUNGDONGSU/smate-urban/blob/main/Smart_URBAN_logo.webp?raw=true" alt="쌍용 스마트어반 로고" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: auto; max-width: 25%; height: auto; z-index: 2; animation: fadeInEntrance 1.5s ease-out forwards, neonPulse 2s infinite alternate ease-in-out; filter: drop-shadow(0 0 10px rgba(0,255,255,0.8));">
    <div class="overlay-text">
      <h2>당신의 미래가 머무는 곳!,<br class="mobile-only-break"> 쌍용 스마트어반</h2>
    </div>
  </section>

  <section class="intro">
    <h2>프리미엄 라이프의 시작</h2>
    <p>
      경기도 평택시 진위면에 위치한 쌍용 스마트어반은 교통, 교육, 생활 인프라를 두루 갖춘 프리미엄 주거단지입니다.<br>
      총 1,228세대, 4Bay 구조와 혁신적인 평면 설계, 풍부한 커뮤니티 시설까지.<br>
      당신의 삶을 더욱 가치 있게 만들어줄 새로운 시작을 지금 만나보세요.
    </p>
  </section>

  <div class="container">
    <section class="form-section">
      <h3 class="highlight-title">상담 예약</h3>
      <form id="inquiryForm">
        <div>
            <label for="userName">성함</label>
            <input type="text" id="userName" placeholder="성함을 입력하세요">
        </div>
        <div>
            <label for="userPhone">연락처</label>
            <input type="text" id="userPhone" placeholder="연락처를 입력하세요 (예: 010-1234-5678)">
        </div>
        <div>
            <label for="userAddress">주소</label>
            <input type="text" id="userAddress" placeholder="주소를 입력하세요">
        </div>
        <div>
            <label for="inquiryType">문의유형</label>
            <select id="inquiryType">
              <option value="">문의유형 선택</option>
              <option value="상담예약">상담예약</option>
              <option value="방문예약">방문예약</option>
              <option value="기타">기타</option>
            </select>
        </div>
        <div>
            <label for="otherInquiry">기타 문의 내용</label>
            <textarea id="otherInquiry" placeholder="기타 문의사항이 있다면 입력해주세요" rows="4"></textarea>
        </div>
        <div>
            <label for="agreeCheckbox">
                <input type="checkbox" id="agreeCheckbox"> 개인정보 수집 및 이용에 동의합니다.
            </label>
        </div>
        <div class="privacy-text">
          ※ 수집된 개인정보는 분양상담 및 향후 관련 정보 안내 목적으로만 활용되며,<br>
          이용자의 요청 시 언제든지 삭제 요청이 가능합니다.
        </div>
        <button type="submit" id="submitBtn">상담 예약 등록</button>
      </form>
    </section>
  </div>

<script>
  // Get form elements
  const inquiryForm = document.getElementById('inquiryForm');
  const agreeCheckbox = document.getElementById('agreeCheckbox');
  const submitBtn = document.getElementById('submitBtn');
  
  // *** 여기에 Apps Script 웹 앱 URL을 붙여넣으세요 ***
  // Google Apps Script를 배포한 후 얻게 될 '웹 앱 URL'로 변경해야 합니다.
  const APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxXIk69N_Qtbgw_HkXZAJDO1cesyupll6mz6V4jVs6IPhP-kwbh09nq9kNBoushrPbwtg/exec'; 

  // --- Mobile Navigation (Hamburger Menu) Logic ---
  const hamburgerButton = document.querySelector('.hamburger-menu');
  const navigationMenu = document.querySelector('.nav-menu'); 
  const navLinks = document.querySelectorAll('.nav-menu ul li a');

  if (hamburgerButton && navigationMenu) {
    hamburgerButton.addEventListener('click', () => {
      navigationMenu.classList.toggle('nav-open'); // Toggle class on <nav> element
      hamburgerButton.classList.toggle('active'); // Toggle class on hamburger button itself (for X shape)
      
      // Update ARIA attributes for accessibility
      const isExpanded = navigationMenu.classList.contains('nav-open');
      hamburgerButton.setAttribute('aria-expanded', isExpanded);
      if (isExpanded) {
        hamburgerButton.setAttribute('aria-label', '메뉴 닫기');
      } else {
        hamburgerButton.setAttribute('aria-label', '메뉴 열기');
      }
    });

    // Close menu when a link is clicked in mobile navigation
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (navigationMenu.classList.contains('nav-open')) {
          navigationMenu.classList.remove('nav-open');
          hamburgerButton.classList.remove('active');
          hamburgerButton.setAttribute('aria-expanded', 'false');
          hamburgerButton.setAttribute('aria-label', '메뉴 열기');
        }
      });
    });
  }
  // --- End of Mobile Navigation Logic ---


  // Function to update button state (linked to privacy agreement checkbox)
  function updateButtonState() {
    if (agreeCheckbox.checked) {
      submitBtn.classList.remove('btn-disabled');
      submitBtn.disabled = false;
    } else {
      submitBtn.classList.add('btn-disabled');
      submitBtn.disabled = true;
    }
  }

  if (inquiryForm && agreeCheckbox && submitBtn) {
    updateButtonState(); // Set initial button state on page load
    agreeCheckbox.addEventListener('change', updateButtonState); // Update button state on checkbox change

    // 폼 제출 이벤트 리스너 수정 (Google Spreadsheet 연동 부분)
    inquiryForm.addEventListener('submit', async function (event) { // async 키워드 추가
      event.preventDefault(); 

      const name = document.getElementById('userName').value.trim();
      const phone = document.getElementById('userPhone').value.trim();
      const address = document.getElementById('userAddress').value.trim();
      const inquiry = document.getElementById('inquiryType').value;
      const otherText = document.getElementById('otherInquiry').value.trim();

      // 필수 필드 및 유효성 검사 (기존 로직 유지)
      if (!name || !phone || !address) {
        displayMessage('성함, 연락처, 주소는 반드시 입력해야 합니다.');
        return;
      }

      const phoneRegex = /^\d{2,3}-\d{3,4}-\d{4}$/;
      if (!phoneRegex.test(phone)) {
        displayMessage('올바른 연락처 형식을 입력해주세요. (예: 010-1234-5678)');
        return;
      }

      if (inquiry === '') {
        displayMessage('문의 유형을 선택해주세요.');
        return;
      }
      if (inquiry === '기타' && !otherText) {
        displayMessage('기타 문의 내용을 입력해주세요.');
        return;
      }
      
      if (!agreeCheckbox.checked) {
        displayMessage('개인정보 수집 및 이용에 동의해야 등록이 가능합니다.');
        return;
      }

      // 데이터 객체 생성 (Apps Script로 보낼 데이터)
      const formData = {
        userName: name,
        userPhone: phone,
        userAddress: address,
        inquiryType: inquiry,
        otherInquiry: otherText
      };

      submitBtn.classList.add('btn-disabled'); // 제출 중 버튼 비활성화
      submitBtn.disabled = true;
      submitBtn.textContent = '등록 중...'; // 사용자에게 피드백 제공

      try {
        // Apps Script 웹 앱으로 데이터 전송
        const response = await fetch(APPS_SCRIPT_WEB_APP_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json' // JSON 형식으로 데이터 전송
          },
          body: JSON.stringify(formData) // 데이터 객체를 JSON 문자열로 변환하여 전송
        });

        const result = await response.json(); // Apps Script의 응답 (JSON) 파싱

        if (response.ok && result.success) { // 서버 응답이 성공적일 경우
          displayMessage('정상적으로 등록되었습니다! 담당자가 곧 연락드릴 예정입니다.');
          inquiryForm.reset(); 
          document.getElementById('otherInquiry').value = ''; 
          updateButtonState(); // 폼 초기화 후 버튼 상태 업데이트
        } else { // 서버 응답이 실패일 경우
          displayMessage(`상담 예약 실패: ${result.message || '알 수 없는 오류가 발생했습니다.'}`);
        }
      } catch (error) {
        console.error('Error submitting form:', error);
        displayMessage('네트워크 오류가 발생했습니다. 다시 시도해주세요.');
      } finally {
        submitBtn.classList.remove('btn-disabled'); // 완료 후 버튼 다시 활성화
        submitBtn.disabled = false;
        submitBtn.textContent = '상담 예약 등록';
      }
    });
  }

  // Custom message box function (replaces alert)
  function displayMessage(message) {
    const messageBox = document.createElement('div');
    messageBox.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      border-radius: 8px;
      z-index: 2000;
      text-align: center;
      font-size: 1.1em;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      max-width: 80%;
    `;
    messageBox.textContent = message;
    document.body.appendChild(messageBox);

    setTimeout(() => {
      messageBox.remove();
    }, 3000); // Message disappears after 3 seconds
  }
</script>
<script>
  // Ensure the canvas script runs after the DOM is fully loaded
  window.addEventListener('DOMContentLoaded', () => {
    const canvas = document.getElementById('sparkle-canvas');
    const ctx = canvas.getContext('2d');

    // Function to resize the canvas to match its parent's dimensions
    function resizeCanvas() {
      canvas.width = canvas.parentElement.clientWidth; 
      canvas.height = canvas.parentElement.clientHeight;
    }
    resizeCanvas(); // Initial canvas size adjustment
    window.addEventListener('resize', resizeCanvas); // Adjust canvas size on window resize

    // Array to hold sparkle objects
    const sparkles = [];
    const SPARKLE_COUNT = 50;

    // Array to hold shooting star objects (will usually have 0 or 1 element)
    const shootingStars = [];
    let timeToNextShootingStar = 0; // Countdown timer in frames until next shooting star appears

    // Factory function to create a new sparkle object
    function createSparkle() {
      // Generate a random hue for rainbow colors (0-360 degrees)
      const hue = Math.floor(Math.random() * 360);
      // Keep saturation and lightness high for vibrant colors
      const saturation = 70 + Math.random() * 30; // 70-100%
      const lightness = 60 + Math.random() * 20; // 60-80%
      const color = `hsl(${hue}, ${saturation}%, ${lightness}%)`;

      return {
        x: Math.random(), // Normalized x position (0 to 1)
        y: Math.random(), // Normalized y position (0 to 1)
        size: 2 + Math.random() * 5, // Base sparkle size - DOUBLED
        alpha: 0.2 + Math.random() * 0.6, // Base opacity
        color: color, // Random rainbow color
        life: 300 + Math.random() * 500, // Sparkle lifespan in frames
        age: 0 // Current sparkle age in frames
      };
    }

    // Factory function to create a new shooting star object
    function createShootingStar() {
      let startX, startY, angle;
      const edge = Math.floor(Math.random() * 3); // 0: Top, 1: Left, 2: Right

      if (edge === 0) { // Starts from the top edge
        startX = Math.random() * canvas.width;
        startY = -20; // Slightly off-screen at the top
        angle = Math.PI / 2 + (Math.random() - 0.5) * (Math.PI / 3.5); // Downwards, with slight angle variation
      } else if (edge === 1) { // Starts from the left edge
        startX = -20;
        startY = Math.random() * canvas.height * 0.6; // Not too low
        angle = (Math.random() * (Math.PI / 4)) + Math.PI / 8; // Down-right direction
      } else { // Starts from the right edge
        startX = canvas.width + 20;
        startY = Math.random() * canvas.height * 0.6;
        angle = Math.PI - ((Math.random() * (Math.PI / 4)) + Math.PI / 8); // Down-left direction
      }

      // Modified shooting star speed: half of the original speed
      const speed = (1.25 + Math.random() * 1.75); 
      return {
        x: startX,
        y: startY,
        dx: Math.cos(angle) * speed,
        dy: Math.sin(angle) * speed,
        size: 1.5 + Math.random() * 2, // Shooting star head size
        tailLength: 10 + Math.random() * 15, // Tail length (based on number of frames)
        color: `rgba(255, 255, ${Math.floor(210 + Math.random() * 46)}, 1)`, // Bright white or slightly yellowish color
        opacity: 0.6 + Math.random() * 0.4, // Base opacity (used for fade effect)
        life: 150 + Math.random() * 150, // Lifespan in frames
        age: 0
      };
    }

    // Helper function to draw a star shape
    function drawStar(context, cx, cy, spikes, outerRadius, innerRadius) {
      let rot = Math.PI / 2 * 3;
      let x = cx;
      let y = cy;
      let step = Math.PI / spikes;

      context.beginPath();
      context.moveTo(cx, cy - outerRadius);
      for (let i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        context.lineTo(x, y);
        rot += step;

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        context.lineTo(x, y);
        rot += step;
      }
      context.lineTo(cx, cy - outerRadius);
      context.closePath();
    }

    // Initialize sparkles
    for (let i = 0; i < SPARKLE_COUNT; i++) {
      sparkles.push(createSparkle());
    }
    // Shooting stars are not created initially; the first one will be generated
    // immediately in the first frame since timeToNextShootingStar is 0.

    // Function to draw all effects
    function drawEffects() {
      ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas every frame

      // Draw sparkles
      for (let s of sparkles) {
        const t = s.age / s.life;
        let sparkleAlpha = Math.sin(Math.PI * t);
        sparkleAlpha = Math.max(sparkleAlpha, 0.01); // Ensure alpha doesn't go to zero
        ctx.globalAlpha = s.alpha * sparkleAlpha;

        const actualX = s.x * canvas.width;
        const actualY = s.y * canvas.height;
        const actualSize = s.size * (0.7 + sparkleAlpha * 0.8);
        
        // Draw star shape instead of circle
        drawStar(ctx, actualX, actualY, 5, actualSize, actualSize / 2); // 5 points, inner radius half of outer

        ctx.fillStyle = s.color;
        ctx.shadowColor = s.color;
        ctx.shadowBlur = 8 + 15 * sparkleAlpha;
        ctx.fill();
        ctx.shadowBlur = 0; // Reset shadow blur

        s.age++;
        if (s.age > s.life) {
          Object.assign(s, createSparkle()); // Recreate sparkle if its life is over
        }
      }
      ctx.globalAlpha = 1; // Reset globalAlpha for other drawings

      // Draw and manage shooting stars (iterate backwards to avoid index issues when removing)
      for (let i = shootingStars.length - 1; i >= 0; i--) {
        const ss = shootingStars[i];
        ss.x += ss.dx;
        ss.y += ss.dy;
        ss.age++;

        const lifeRatio = ss.age / ss.life;
        let currentOpacity;
        if (lifeRatio < 0.15) { // Fade in at the beginning
          currentOpacity = (lifeRatio / 0.15) * ss.opacity;
        } else if (lifeRatio > 0.75) { // Fade out at the end
          currentOpacity = (1 - (lifeRatio - 0.75) / 0.25) * ss.opacity;
        } else { // Full opacity in the middle
          currentOpacity = ss.opacity;
        }
        currentOpacity = Math.max(0, Math.min(1, currentOpacity)); // Clamp opacity between 0 and 1

        // Draw tail
        const tailColor = ss.color.replace(/[\d\.]+(?=\))/, currentOpacity.toFixed(2));
        ctx.strokeStyle = tailColor;
        ctx.lineWidth = ss.size * 0.4; // Thinner tail
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(ss.x - ss.dx * ss.tailLength, ss.y - ss.dy * ss.tailLength);
        ctx.lineTo(ss.x, ss.y);
        ctx.stroke();

        // Draw head
        const headOpacity = Math.min(1, currentOpacity * 1.2); // Slightly brighter head
        const headColor = ss.color.replace(/[\d\.]+(?=\))/, headOpacity.toFixed(2));
        ctx.fillStyle = headColor;
        ctx.shadowColor = ss.color.replace(/[\d\.]+(?=\))/, (headOpacity * 0.7).toFixed(2));
        ctx.shadowBlur = 8 + ss.size * 3;
        ctx.beginPath();
        ctx.arc(ss.x, ss.y, ss.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0; // Reset shadow blur

        // Check if shooting star is out of bounds
        let outOfBounds = false;
        const buffer = ss.tailLength * Math.max(Math.abs(ss.dx), Math.abs(ss.dy)) + 50; // Buffer zone for removal
        if (ss.dx > 0 && ss.x > canvas.width + buffer) outOfBounds = true;
        else if (ss.dx < 0 && ss.x < -buffer) outOfBounds = true;
        if (ss.dy > 0 && ss.y > canvas.height + buffer) outOfBounds = true;

        // Remove shooting star if its life is over or it's out of bounds
        if (ss.age > ss.life || outOfBounds) {
          shootingStars.splice(i, 1); // Remove shooting star
          timeToNextShootingStar = Math.floor(Math.random() * (3 * 60)) + (1 * 60); // Set new countdown for next shooting star (1 to 4 seconds)
        }
      }

      // Create a new shooting star if none exist and timer is up
      if (shootingStars.length === 0) {
        if (timeToNextShootingStar <= 0) {
          shootingStars.push(createShootingStar());
        } else {
          timeToNextShootingStar--;
        }
      }
      requestAnimationFrame(drawEffects); // Request next animation frame
    }

    drawEffects(); // Start the animation loop
  });
</script>
  <footer style="background-color: #e0e0e0; padding: 20px; text-align: center; margin-top: 60px;">
  <img src="https://github.com/JUNGDONGSU/smate-urban/blob/main/logo.png?raw=true" alt="쌍용 스마트어반 로고" style="max-width: 180px; height: auto;">
</footer>
</body>
</html>
